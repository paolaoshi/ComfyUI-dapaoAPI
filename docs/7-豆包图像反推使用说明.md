# 豆包图像反推节点使用说明

## 📖 节点简介

豆包图像反推节点基于字节跳动豆包 Seed-1.6 Vision 多模态大模型，能够深入分析图像内容并生成详细的文本描述，非常适合用于生成图像的提示词。

## 🎯 主要功能

- ✅ 多图联合分析（最多4张图片）
- ✅ 智能提示词生成
- ✅ 详细场景描述
- ✅ 风格特征提取
- ✅ 种子控制（固定/随机/递增）
- ✅ 自定义分析角度

## 📝 参数说明

### 必填参数

| 参数名 | 类型 | 说明 |
|--------|------|------|
| **🖼️ 图像1** | IMAGE | 第一张必须的图片 |
| **🔑 API密钥** | STRING | 豆包 API 密钥（留空则从配置文件读取） |
| **📝 反推指令** | STRING | 图像分析指令 |

### 可选参数

| 参数名 | 类型 | 默认值 | 说明 |
|--------|------|--------|------|
| **🖼️ 图像2-4** | IMAGE | 无 | 可选的额外图片（最多3张） |
| **🤖 视觉模型** | STRING | doubao-seed-1-6-vision-250815 | 使用的豆包视觉模型 |
| **🎲 随机种子** | INT | 0 | 固定种子值 |
| **🎛️ 种子控制** | DROPDOWN | 随机 | 种子生成方式（固定/随机/递增） |

## 🤖 模型说明

| 模型名称 | 特点 | 适用场景 |
|----------|------|----------|
| **doubao-seed-1-6-vision-250815** | 速度快，识别准确 | 图像分析、提示词生成 |

## 📄 默认反推指令

节点内置了专业的反推指令模板：

```
你是一个专业的图像分析专家，能够将图片内容转化为高质量的英文提示词。

请仔细观察图片，生成详细的英文描述，包括：
1. 主体：人物/物体的外观、特征、表情、动作
2. 场景：环境、背景、时间、天气、光线
3. 构图：视角、景别、空间关系
4. 风格：艺术风格、色彩、氛围、质感
5. 细节：纹理、材质、装饰、道具等

要求：
- 使用英文
- 详细具体
- 用逗号连接不同描述
- 末尾添加画质词：high quality, ultra detailed, masterpiece

只输出最终的英文提示词，不要包含解释。
```

## 🖼️ 多图分析

### 单图分析
最常用模式，深入分析一张图片：
```
输入：🖼️ 图像1（一张图）
输出：完整的图像描述或提示词
```

### 双图对比
分析两张图的异同：
```
输入：
- 🖼️ 图像1：图片A
- 🖼️ 图像2：图片B
- 📝 反推指令："对比这两张图的风格差异"

输出：对比分析结果
```

### 多图关联
分析多张图的关联关系：
```
输入：
- 🖼️ 图像1 + 图像2 + 图像3 + 图像4（最多4张）
- 📝 反推指令："总结这组图片的共同主题"

输出：综合分析结果
```

### 系列图分析
生成系列图的统一风格描述：
```
输入：多张风格相似的图片
- 📝 反推指令："提取这些图片的共同风格特征"

输出：统一风格提示词
```

## 🎲 种子控制

| 控制方式 | 说明 | 适用场景 |
|----------|------|----------|
| **随机** | 每次分析结果略有不同 | 探索多种描述角度 |
| **固定** | 使用固定种子，结果一致 | 批量处理时保持风格统一 |
| **递增** | 种子值递增，渐进变化 | 生成系列变体描述 |

## 💡 使用技巧

### 1. 反推AI绘画提示词
```
配置：
- 📝 反推指令：使用默认指令
- 🎛️ 种子控制：随机

适合：将喜欢的图片转换为可用于AI绘画的提示词
```

### 2. 学习摄影构图
```
配置：
- 📝 反推指令："详细分析这张照片的构图、光线、色彩和拍摄技巧"

适合：学习摄影技巧
```

### 3. 风格提取
```
配置：
- 输入多张同风格图片
- 📝 反推指令："总结这种艺术风格的特点，包括色彩、构图、技法"

适合：风格学习与复现
```

### 4. 图像对比
```
配置：
- 🖼️ 图像1 + 图像2
- 📝 反推指令："对比两张图的差异，生成改进建议"

适合：版本对比、改进参考
```

### 5. 批量反推
```
配置：
- 🎛️ 种子控制：固定
- 🎲 随机种子：设置一个固定值

适合：批量处理图库，生成统一风格的提示词
```

## 🎯 自定义反推指令示例

### 场景1：生成AI绘画提示词（英文）
```
请用简洁的英文关键词描述这张图片，包括主体、风格、光线、色调，
用逗号分隔，适合用于AI绘画。末尾添加：high quality, ultra detailed, masterpiece
```

### 场景2：详细场景分析（中文）
```
请用中文详细描述这张图片的场景、人物、环境、氛围、光线、色彩和构图
```

### 场景3：风格特征提取
```
请分析这张图片的艺术风格特点，包括绘画技法、色彩运用、构图特色
```

### 场景4：多图关联分析
```
请分析这几张图片之间的关联性，找出共同主题或风格特征
```

### 场景5：对比分析
```
请对比这两张图片的差异，从构图、色彩、风格、主题等角度进行分析
```

### 场景6：提取技术参数
```
请分析这张图片的技术参数，包括：拍摄角度、景深、光圈、ISO、快门速度（如果能识别）
```

### 场景7：情感分析
```
请分析这张图片传达的情感和氛围，描述观众可能产生的感受
```

## ⚙️ 快速配置指南

### 快速预览模式
```
- 🖼️ 图像1：上传图片
- 📝 反推指令：使用默认
- 🎛️ 种子控制：随机
- 用途：快速了解图片内容
```

### 标准反推模式
```
- 🖼️ 图像1：上传图片
- 📝 反推指令：使用默认（英文提示词）
- 🎛️ 种子控制：随机
- 用途：日常反推提示词
```

### 批量处理模式
```
- 🖼️ 图像1：上传图片
- 📝 反推指令：使用默认
- 🎛️ 种子控制：固定
- 🎲 随机种子：12345（固定值）
- 用途：批量反推，保持一致性
```

### 创意探索模式
```
- 🖼️ 图像1：上传图片
- 📝 反推指令：自定义创意指令
- 🎛️ 种子控制：递增
- 用途：生成多样化的描述变体
```

## ⚠️ 注意事项

1. **图片质量**：
   - 建议使用清晰、高质量的图片
   - 模糊或低分辨率图片可能影响分析准确度

2. **多图分析**：
   - 第一张图（图像1）为主要分析对象
   - 附加图片作为补充参考
   - 最多支持4张图片同时分析

3. **种子控制**：
   - 豆包API支持完整的64位种子值范围
   - 种子值为0时不使用固定种子

4. **API成本**：
   - 多图分析会增加token消耗
   - 详细的反推指令会增加处理时间

5. **输出格式**：
   - 默认指令生成英文提示词
   - 可自定义指令要求中文输出
   - 可要求特定格式（JSON、结构化等）

6. **网络连接**：
   - 需要稳定的网络连接到火山引擎API
   - 超时时间默认120秒，可在配置文件中调整

## 🔧 配置文件

在 `doubao_config.json` 中预设API密钥：

```json
{
    "doubao_api_key": "你的豆包API密钥",
    "doubao_base_url": "https://ark.cn-beijing.volces.com/api/v3",
    "doubao_vision_endpoint": "doubao-seed-1-6-vision-250815",
    "timeout": 120
}
```

### 配置说明

| 配置项 | 说明 | 默认值 |
|--------|------|--------|
| `doubao_api_key` | 豆包API密钥 | 空（必填） |
| `doubao_base_url` | API基础URL | https://ark.cn-beijing.volces.com/api/v3 |
| `doubao_vision_endpoint` | 视觉模型端点ID | doubao-seed-1-6-vision-250815 |
| `timeout` | 请求超时时间（秒） | 120 |

## 📋 获取 API 密钥

1. 访问 [火山引擎控制台](https://console.volcengine.com/)
2. 进入「方舟」服务
3. 创建或选择推理接入点
4. 获取 API Key（注意保密）
5. 将 API Key 填入 `doubao_config.json` 或节点参数中

## 🔗 节点连接示例

### 基础工作流
```
加载图像 → 豆包图像反推 → 文本展示
                        ↓
                      Seedream文生图
```

### 图生图工作流
```
加载图像 → 豆包图像反推 → GLM提示词润色 → Seedream文生图
     ↓                                          ↓
     └──────────────────────────────────→ 图像预处理
```

### 批量反推工作流
```
图像批量加载 → 豆包图像反推（固定种子） → 批量保存文本
```

### 对比分析工作流
```
图像A ──┐
        ├→ 豆包图像反推 → 对比结果展示
图像B ──┘   (使用对比指令)
```

## 💬 常见问题

### Q1: 图像反推结果每次都不一样？
**A:** 这是正常现象。可以设置「🎛️ 种子控制」为「固定」，并设置一个具体的种子值来获得一致的结果。

### Q2: 如何生成中文描述？
**A:** 在「📝 反推指令」中明确要求使用中文，例如："请用中文详细描述这张图片..."

### Q3: 多图分析时图片顺序重要吗？
**A:** 图像1是主要分析对象，其他图像作为参考。如果要对比，建议在反推指令中明确说明。

### Q4: API调用失败怎么办？
**A:** 
1. 检查 API Key 是否正确
2. 检查网络连接
3. 确认火山引擎账户余额充足
4. 查看终端日志获取详细错误信息

### Q5: 能否反推视频？
**A:** 当前版本仅支持图像，不支持视频。可以提取视频帧后进行分析。

### Q6: 种子递增模式有什么用？
**A:** 适合生成渐进变化的描述。例如，对同一图片生成10个略有不同的提示词变体。

## 📚 相关链接

- [火山引擎控制台](https://console.volcengine.com/)
- [豆包 Seed-1.6 模型文档](https://www.volcengine.com/docs/82379/1298454)
- [火山方舟服务](https://www.volcengine.com/product/ark)
- [如何获取 API Key](https://console.volcengine.com/ark/region:ark+cn-beijing/apiKey)

## 🆚 与GLM图像反推对比

| 特性 | 豆包图像反推 | GLM图像反推 |
|------|-------------|------------|
| 模型提供商 | 字节跳动 | 智谱AI |
| 模型版本 | Seed-1.6 Vision | GLM-4V |
| 种子范围 | 完整64位 | 1-2147483647 |
| 多图支持 | ✅ 最多4张 | ✅ 最多4张 |
| API调用方式 | HTTP请求 | 官方SDK |
| 配置文件 | doubao_config.json | glm_config.json |

---

**作者**：@炮老师的小课堂  
**版本**：v1.0.0  
**更新日期**：2024年11月

---

## 🎨 示例输出

### 输入图片：一位穿白裙的女孩在樱花树下

**英文提示词输出示例：**
```
A young woman with long flowing hair, wearing an elegant white dress, 
standing under blooming cherry blossom trees, gentle smile, soft natural 
lighting, shallow depth of field, pink petals falling, serene atmosphere, 
spring season, pastel colors, dreamy mood, high quality, ultra detailed, 
masterpiece
```

**中文描述输出示例：**
```
画面中是一位年轻女性，拥有一头飘逸的长发。她身穿一袭优雅的白色连衣裙，
站在盛开的樱花树下。女性面带温柔的微笑，眼神宁静而美好。粉色的樱花花瓣
在微风中轻轻飘落，营造出梦幻般的氛围。整体光线柔和自然，采用浅景深拍摄，
背景虚化突出主体。色调以粉色和白色为主，清新淡雅，充满春天的气息。
```

